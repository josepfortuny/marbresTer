"use strict";function t(t,e,r,n){return!/^(__proto__|constructor|prototype)$/.test(e)&&((e=e.split?e.split("."):e.slice(0)).slice(0,-1).reduce((function(t,e){return t[e]=t[e]||{}}),t)[e.pop()]=r),t}function e(t,e){return null!=t?t:e}function r(t,r,n,i){return e(e(n[r],i[r]),t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createPersistedStatePlugin=function(e){var n=e||{};return function(e){var i=function(){try{return e.options.persistedState||{}}catch(t){return{}}}();if(!1!==r(!0,"persist",i,n)){var o,s=r(e.store.$id,"key",i,{}),u=r(!1,"overwrite",i,n),c=r(function(){try{return window.localStorage}catch(t){return{getItem:function(){},setItem:function(){},removeItem:function(){}}}}(),"storage",i,n),a=r((function(){return!0}),"filter",i,n),f=r(JSON.stringify,"serialize",i,n),l=r(JSON.parse,"deserialize",i,n),d=r((function(t){return t}),"migrate",i,{}),p=r((function(t,e){return e}),"merge",i,{}),y=new Promise((function(t){o=t})),h=0;e.store.$persistedState={isReady:function(){return y},pending:!1};try{var m=c.getItem(s);m instanceof Promise?m.then(g):g(m)}catch(t){o()}e.store.$subscribe((function(r,n){if(!1!==a(r,n)){Array.isArray(i.includePaths)&&(n=i.includePaths.reduce((function(e,r){return t(e,r,function(t,e,r){return void 0===(t=(e.split?e.split("."):e).reduce((function(t,e){return t&&t[e]}),t))?r:t}(n,r))}),{})),Array.isArray(i.excludePaths)&&(n=l(f(n)),i.excludePaths.forEach((function(e){return t(n,e,void 0)}),{}));var o=f(n),u=c.setItem(s,o);u instanceof Promise&&(++h,e.store.$persistedState.pending=0!==h,u.catch((function(){})).finally((function(){--h,e.store.$persistedState.pending=0!==h})))}}))}function v(t){(i.beforeHydrate||function(){})(e.store.$state);var r=p(e.store.$state,t);u?e.store.$state=r:e.store.$patch(r),o()}function g(t){if(null!=t){var e=l(t),r=d(e);r instanceof Promise?r.then(v):v(r)}else o()}}};
